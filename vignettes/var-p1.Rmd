---
title: "fitAutoReg: Vector Autoregressive Model - VAR(p = 1)"
author: "Ivan Jacob Agaloos Pesigan"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{fitAutoReg: Vector Autoregressive Model - VAR(p = 1)}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---




```r
library(simAutoReg)
library(fitAutoReg)
#> 
#> Attaching package: 'fitAutoReg'
#> The following objects are masked from 'package:simAutoReg':
#> 
#>     SimVAR, YX
```

## Generate data


```r
set.seed(42)
time <- 1000L
burn_in <- 200L
k <- 3
p <- 1
constant <- c(1, 1, 1)
coef <- matrix(
  data = c(
    0.4, 0.0, 0.0,
    0.0, 0.5, 0.0,
    0.0, 0.0, 0.6
  ),
  nrow = k,
  byrow = TRUE
)
chol_cov <- chol(diag(3))
dat_p1 <- simAutoReg::SimVAR(
  time = time,
  burn_in = burn_in,
  constant = constant,
  coef = coef,
  chol_cov = chol_cov
)
```

## Ordinary Least Squares


```r
Y <- dat_p1_yx$Y
X <- dat_p1_yx$X
FitVAROLS(Y = Y, X = X)
#>           [,1]         [,2]       [,3]        [,4]
#> [1,] 0.9084572  0.376670213 0.03481382 0.015427806
#> [2,] 0.9952570  0.002299374 0.51052755 0.002902186
#> [3,] 1.0653119 -0.041211382 0.02013807 0.601902383
```

## Lasso Regularization


```r
Ystd <- StdMat(dat_p1_yx$Y)
Xstd <- StdMat(dat_p1_yx$X[, -1])
lambdas <- LambdaSeq(Y = Ystd, X = Xstd, n_lambdas = 100)
FitVARLassoSearch(Ystd = Ystd, Xstd = Xstd, lambdas = lambdas,
  crit = "ebic", max_iter = 1000, tol = 1e-5)
#>           [,1]      [,2]      [,3]
#> [1,] 0.3372619 0.0000000 0.0000000
#> [2,] 0.0000000 0.4718716 0.0000000
#> [3,] 0.0000000 0.0000000 0.5638745
```

## Dynr


```r
dynr_model <- ModelVARP1Dynr(data = dat_p1)
coef(
  object = dynr_model,
  dynr_cook = FitVARDynr(model = dynr_model, hessian_flag = FALSE)
)
#> $constant
#> [1] 0.9099447 0.9914348 1.0581366
#> 
#> $coef
#>             [,1]       [,2]        [,3]
#> [1,]  0.37660403 0.03434456 0.015729610
#> [2,]  0.00325585 0.51111108 0.003139214
#> [3,] -0.03962967 0.02120156 0.602733814
#> 
#> $cov
#>              [,1]         [,2]         [,3]
#> [1,]  0.990292758 -0.054644587 -0.005531848
#> [2,] -0.054644587  1.010813947  0.006040567
#> [3,] -0.005531848  0.006040567  0.984040302
```

### Multiple individuals


```r
n <- 10 # n individuals
dat_p1_mult <- lapply(
  X = seq_len(n),
  FUN = function(i) {
    return(
      simAutoReg::SimVAR(
        time = 1000L,
        burn_in = 10,
        constant = constant,
        coef = coef,
        chol_cov = chol_cov
      )
    )
  }
)
```

Single VAR model on the entire data set.


```r
dynr_model <- ModelVARP2Dynr(data = dat_p1_mult)
coef(
  object = dynr_model,
  dynr_cook = FitVARDynr(model = dynr_model, hessian_flag = FALSE)
)
#> $constant
#> [1] 1.0462309 0.9953261 1.0179085
#> 
#> $coef
#>             [,1]         [,2]         [,3]         [,4]         [,5]
#> [1,]  0.40217196 -0.012849009 -0.007795745  0.006281066 -0.006239730
#> [2,] -0.00682165  0.505751441 -0.011788660 -0.003103103  0.008279539
#> [3,] -0.01854566  0.006197221  0.583717514 -0.001061644  0.017521378
#>             [,6]
#> [1,] 0.003882397
#> [2,] 0.007311607
#> [3,] 0.006326369
#> 
#> $cov
#>             [,1]        [,2]         [,3]
#> [1,]  0.99881717 0.017241274 -0.016248986
#> [2,]  0.01724127 0.982213749  0.004933834
#> [3,] -0.01624899 0.004933834  0.998348889
```

Multiple VAR models on each individual.


```r
dynr_cook <- FitMLVARDynr(data = dat_p1_mult, p = 2, hessian_flag = FALSE)
#> Error in FUN(X[[i]], ...): unused argument (conf.level = 0.95)
dynr_model <- ModelVARP2Dynr(data = dat_p1_mult[[1]])
lapply(
  X = dynr_cook,
  FUN = function(dynr_cook,
                 dynr_model) {
    coef(
      object = dynr_model,
      dynr_cook = dynr_cook
    )
  },
  dynr_model = ModelVARP2Dynr(data = dat_p1_mult[[1]])
)
#> Error in eval(expr, envir, enclos): object 'dynr_cook' not found
```
