---
title: "fitAutoReg: Vector Autoregressive Model - VAR(p = 1)"
author: "Ivan Jacob Agaloos Pesigan"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{fitAutoReg: Vector Autoregressive Model - VAR(p = 1)}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---




```r
library(fitAutoReg)
```

## Generate data


```r
set.seed(42)
time <- 1000L
burn_in <- 200L
k <- 3
p <- 1
constant <- c(1, 1, 1)
coef <- matrix(
  data = c(
    0.4, 0.0, 0.0,
    0.0, 0.5, 0.0,
    0.0, 0.0, 0.6
  ),
  nrow = k,
  byrow = TRUE
)
chol_cov <- chol(diag(3))
dat_p1 <- SimVAR(
  time = time,
  burn_in = burn_in,
  constant = constant,
  coef = coef,
  chol_cov = chol_cov
)
```

## Ordinary Least Squares


```r
Y <- dat_p1_yx$Y
X <- dat_p1_yx$X
FitVAROLS(Y = Y, X = X)
#>           [,1]         [,2]       [,3]        [,4]
#> [1,] 0.9084572  0.376670213 0.03481382 0.015427806
#> [2,] 0.9952570  0.002299374 0.51052755 0.002902186
#> [3,] 1.0653119 -0.041211382 0.02013807 0.601902383
```

## Lasso Regularization


```r
YStd <- StdMat(dat_p1_yx$Y)
XStd <- StdMat(dat_p1_yx$X[, -1])
lambdas <- LambdaSeq(YStd = YStd, XStd = XStd, n_lambdas = 100)
FitVARLassoSearch(YStd = YStd, XStd = XStd, lambdas = lambdas,
  crit = "ebic", max_iter = 1000, tol = 1e-5)
#>           [,1]      [,2]      [,3]
#> [1,] 0.3372619 0.0000000 0.0000000
#> [2,] 0.0000000 0.4718716 0.0000000
#> [3,] 0.0000000 0.0000000 0.5638745
```
